---
description: Generate an SRAA compliance audit report from collected findings
argument-hint: "[--format <md|html>] [--domain <name>]"
allowed-tools: ["Read", "Write", "Glob", "Grep"]
---

# SRAA Report Generation Command

Generate a comprehensive SRAA compliance audit report from the findings collected in `.claude/sraa-audit/findings/`.

## Arguments

- `--format <md|html>` - Output format (default: md)
- `--domain <name>` - Generate report for specific domain only:
  - `security-controls`
  - `application-security`
  - `policy-compliance`
  - `infrastructure`

## Execution Steps

### Step 1: Verify Audit Data

1. Check that `.claude/sraa-audit/` directory exists
2. If not exists, display error:
   ```
   No audit data found. Run /sraa:audit first to collect findings.
   ```
3. Read `audit-state.md` to get audit metadata

### Step 2: Collect Findings

Read all finding files from `.claude/sraa-audit/findings/`:
- `security-controls.md`
- `application-security.md`
- `policy-compliance.md`
- `infrastructure.md`

If `--domain` specified, only read that domain's file.

Parse findings to extract:
- Finding ID
- Severity
- Domain
- Control Reference
- Status
- Description
- Evidence
- Recommendation

### Step 3: Generate Report

Create report in `.claude/sraa-audit/reports/` with timestamp:
- `sraa-report-YYYY-MM-DD.md` (or `.html`)

#### Markdown Report Structure

```markdown
# SRAA Compliance Audit Report

**Project:** [Project Name]
**Generated:** [ISO timestamp]
**Audit Period:** [Start Date] - [End Date]
**Report ID:** SRAA-[YYYYMMDD]-[SEQ]

---

## Executive Summary

### Overview
This report presents the findings from the Security Risk Assessment and Audit (SRAA) conducted on [Project Name]. The assessment evaluated compliance with Hong Kong's S17 Baseline IT Security Policy, G3 IT Security Guidelines, and ISPG-SM01 methodology.

### Key Statistics

| Metric | Value |
|--------|-------|
| Total Findings | [N] |
| Critical | [N] |
| High | [N] |
| Medium | [N] |
| Low | [N] |
| Domains Assessed | [N] |

### Risk Summary

[Brief narrative of overall risk posture]

### Priority Recommendations

1. [Most critical recommendation]
2. [Second priority]
3. [Third priority]

---

## Findings by Severity

### Critical Findings

[List critical findings with full details]

### High Findings

[List high findings with full details]

### Medium Findings

[List medium findings with full details]

### Low Findings

[List low findings with full details]

---

## Findings by Domain

### Security Controls
[Findings for this domain]

### Application Security
[Findings for this domain]

### Policy Compliance
[Findings for this domain]

### Infrastructure
[Findings for this domain]

---

## Remediation Roadmap

### Immediate (24-48 hours)
- [Critical items]

### Short Term (1-2 weeks)
- [High items]

### Medium Term (1-3 months)
- [Medium items]

### Long Term (Next review cycle)
- [Low items]

---

## Appendices

### A. Assessment Methodology
Based on ISPG-SM01 Practice Guide for Security Risk Assessment & Audit.

### B. Control Framework References
- S17 Baseline IT Security Policy v8.2
- G3 IT Security Guidelines v10.2
- OWASP Top 10 (2021)

### C. Evidence Summary
[Table of collected evidence with references]

---

*Report generated by SRAA Compliance Plugin*
```

#### HTML Report Structure

If `--format html` specified, wrap the markdown content in HTML with:
- Professional styling (CSS)
- Printable format
- Table of contents with anchors
- Collapsible sections for findings

### Step 4: Display Summary

After generating report:

```
SRAA Compliance Report Generated
================================

Report saved to: .claude/sraa-audit/reports/sraa-report-2024-01-15.md

Summary:
- Total Findings: 10
- Critical: 1, High: 2, Medium: 4, Low: 3

Top Priority Items:
1. [Critical finding title]
2. [High finding title]
3. [High finding title]

Open the report to review full details and remediation roadmap.
```

## Finding Format in Report

Each finding should be displayed as:

```markdown
### [ID]: [Brief Title]

**Severity:** [Critical|High|Medium|Low]
**Domain:** [Annex C Area]
**Control Reference:** [S17/G3 ID]
**Status:** [Open|Remediated|Accepted]

#### Description
[Full description of the finding]

#### Evidence
- File: `[path:line]`
- Observation: [Details]

#### Impact
[Business/security impact]

#### Recommendation
[Specific remediation steps]

#### Timeline
[Expected remediation timeline based on severity]
```

## Error Handling

- If no findings exist, generate report noting clean audit
- If some domains have no findings, note "No findings" for that domain
- Handle malformed finding files gracefully
